<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MeshKernel: meshkernel::OrthogonalizationAndSmoothing Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MeshKernel
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacemeshkernel.html">meshkernel</a></li><li class="navelem"><a class="el" href="classmeshkernel_1_1_orthogonalization_and_smoothing.html">OrthogonalizationAndSmoothing</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classmeshkernel_1_1_orthogonalization_and_smoothing-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">meshkernel::OrthogonalizationAndSmoothing Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Orthogonalizion (optimize the aspect ratios) and mesh smoothing (optimize internal face angles or area).  
 <a href="classmeshkernel_1_1_orthogonalization_and_smoothing.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_orthogonalization_and_smoothing_8hpp_source.html">OrthogonalizationAndSmoothing.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a7cc6dbf3572f893c936e80f6d57eff98"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeshkernel_1_1_orthogonalization_and_smoothing.html#a7cc6dbf3572f893c936e80f6d57eff98">OrthogonalizationAndSmoothing</a> (std::shared_ptr&lt; <a class="el" href="classmeshkernel_1_1_mesh2_d.html">Mesh2D</a> &gt; mesh, std::shared_ptr&lt; <a class="el" href="classmeshkernel_1_1_smoother.html">Smoother</a> &gt; smoother, std::shared_ptr&lt; <a class="el" href="classmeshkernel_1_1_orthogonalizer.html">Orthogonalizer</a> &gt; orthogonalizer, std::shared_ptr&lt; <a class="el" href="classmeshkernel_1_1_polygons.html">Polygons</a> &gt; polygon, std::shared_ptr&lt; <a class="el" href="classmeshkernel_1_1_land_boundaries.html">LandBoundaries</a> &gt; landBoundaries, <a class="el" href="classmeshkernel_1_1_land_boundaries.html#af722b430ae328691e49daaf616c90f29">LandBoundaries::ProjectToLandBoundaryOption</a> projectToLandBoundaryOption, const <a class="el" href="structmeshkernelapi_1_1_orthogonalization_parameters.html">meshkernelapi::OrthogonalizationParameters</a> &amp;orthogonalizationParameters)</td></tr>
<tr class="separator:a7cc6dbf3572f893c936e80f6d57eff98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac40b0272b753b40dd24a2d270b138991"><td class="memItemLeft" align="right" valign="top"><a id="ac40b0272b753b40dd24a2d270b138991"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeshkernel_1_1_orthogonalization_and_smoothing.html#ac40b0272b753b40dd24a2d270b138991">Initialize</a> ()</td></tr>
<tr class="memdesc:ac40b0272b753b40dd24a2d270b138991"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the object. <br /></td></tr>
<tr class="separator:ac40b0272b753b40dd24a2d270b138991"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36882183b2f25248d84f06861d64b93b"><td class="memItemLeft" align="right" valign="top"><a id="a36882183b2f25248d84f06861d64b93b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeshkernel_1_1_orthogonalization_and_smoothing.html#a36882183b2f25248d84f06861d64b93b">Compute</a> ()</td></tr>
<tr class="memdesc:a36882183b2f25248d84f06861d64b93b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes the entire algorithm. <br /></td></tr>
<tr class="separator:a36882183b2f25248d84f06861d64b93b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad54c20c22842692c9aa098eee4808d53"><td class="memItemLeft" align="right" valign="top"><a id="ad54c20c22842692c9aa098eee4808d53"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeshkernel_1_1_orthogonalization_and_smoothing.html#ad54c20c22842692c9aa098eee4808d53">PrepareOuterIteration</a> ()</td></tr>
<tr class="memdesc:ad54c20c22842692c9aa098eee4808d53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepares the outer iteration, calculates orthogonalizer and smoother coefficients and assable the linear system. <br /></td></tr>
<tr class="separator:ad54c20c22842692c9aa098eee4808d53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf52332adb61bb54610d43923a06566a"><td class="memItemLeft" align="right" valign="top"><a id="aaf52332adb61bb54610d43923a06566a"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeshkernel_1_1_orthogonalization_and_smoothing.html#aaf52332adb61bb54610d43923a06566a">Solve</a> ()</td></tr>
<tr class="memdesc:aaf52332adb61bb54610d43923a06566a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs an inner iteration, update the mesh node positions. <br /></td></tr>
<tr class="separator:aaf52332adb61bb54610d43923a06566a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a907c05be6ae69d5bc51d22e42afa5ca3"><td class="memItemLeft" align="right" valign="top"><a id="a907c05be6ae69d5bc51d22e42afa5ca3"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmeshkernel_1_1_orthogonalization_and_smoothing.html#a907c05be6ae69d5bc51d22e42afa5ca3">FinalizeOuterIteration</a> ()</td></tr>
<tr class="memdesc:a907c05be6ae69d5bc51d22e42afa5ca3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Finalize the outer iteration, computes new mu and face areas, masscenters, circumcenters. <br /></td></tr>
<tr class="separator:a907c05be6ae69d5bc51d22e42afa5ca3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Orthogonalizion (optimize the aspect ratios) and mesh smoothing (optimize internal face angles or area). </p>
<p>This class implements the mesh orthogonalization and smoothing algorithm as described in D-Flow&#160;FM technical manual (consult this manual for the mathematical details on the equations). The algorithm operates on mesh2d and is composed of two differential equations: the first equation maximizes orthogonalization between edges and flow edges and the second equation reduces the differences of the internal mesh angles (mesh smoothness). For this reason, the <a class="el" href="classmeshkernel_1_1_orthogonalization_and_smoothing.html" title="Orthogonalizion (optimize the aspect ratios) and mesh smoothing (optimize internal face angles or are...">OrthogonalizationAndSmoothing</a> class is composed of a smoother and an orthogonalizer, where the nodal contributions are computed by separate classes. Essentially, the algorithm executes the following steps:</p>
<ul>
<li>An initialization step: The original mesh boundaries are saved. In case the mesh needs to be snapped to the land boundaries, the indices of the land boundaries are mapped to the boundary mesh edges (<code><a class="el" href="classmeshkernel_1_1_land_boundaries.html#ade64d4802363ff257d6522d82ce11e27" title="Find the mesh boundary line closest to the land boundary (find_nearest_meshline).">LandBoundaries::FindNearestMeshBoundary</a></code>).</li>
<li>An outer loop, which itself is composed of the following parts:<ol type="1">
<li>Computation of the orthogonalizer contributions.</li>
<li>Computation of the smoother contributions.</li>
<li>Allocation of the linear system to be solved.</li>
<li>Summation of the two contributions (matrix assembly). The two contributions are weighted based on the desired smoothing to orthogonality ratio. OpenMP parallelization is used when summing the terms (loop iterations are independent).</li>
</ol>
</li>
<li>An inner iteration: the resulting linear system is solved explicitly. The nodal coordinates are updated and the nodes moving on the mesh boundary are projected to the original mesh boundary (<code>OrthogonalizationAndSmoothing::SnapMeshToOriginalMeshBoundary</code>). In case a projection to land boundary is requested, the mesh nodes are projected to the land boundaries. An OpenMP parallelization is used in <code><a class="el" href="classmeshkernel_1_1_orthogonalization_and_smoothing.html#aaf52332adb61bb54610d43923a06566a" title="Performs an inner iteration, update the mesh node positions.">OrthogonalizationAndSmoothing::Solve</a></code> because the update of the nodal coordinates is made iteration-independent. </li>
</ul>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a7cc6dbf3572f893c936e80f6d57eff98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cc6dbf3572f893c936e80f6d57eff98">&#9670;&nbsp;</a></span>OrthogonalizationAndSmoothing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">meshkernel::OrthogonalizationAndSmoothing::OrthogonalizationAndSmoothing </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classmeshkernel_1_1_mesh2_d.html">Mesh2D</a> &gt;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classmeshkernel_1_1_smoother.html">Smoother</a> &gt;&#160;</td>
          <td class="paramname"><em>smoother</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classmeshkernel_1_1_orthogonalizer.html">Orthogonalizer</a> &gt;&#160;</td>
          <td class="paramname"><em>orthogonalizer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classmeshkernel_1_1_polygons.html">Polygons</a> &gt;&#160;</td>
          <td class="paramname"><em>polygon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classmeshkernel_1_1_land_boundaries.html">LandBoundaries</a> &gt;&#160;</td>
          <td class="paramname"><em>landBoundaries</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classmeshkernel_1_1_land_boundaries.html#af722b430ae328691e49daaf616c90f29">LandBoundaries::ProjectToLandBoundaryOption</a>&#160;</td>
          <td class="paramname"><em>projectToLandBoundaryOption</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structmeshkernelapi_1_1_orthogonalization_parameters.html">meshkernelapi::OrthogonalizationParameters</a> &amp;&#160;</td>
          <td class="paramname"><em>orthogonalizationParameters</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the parameters </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mesh</td><td>The mesh to orthogonalize </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">smoother</td><td>The mesh to smoother </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">orthogonalizer</td><td>The mesh to orthogonalizer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">polygon</td><td>The polygon where orthogonalization should occur </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">landBoundaries</td><td>The land boundaries </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">projectToLandBoundaryOption</td><td>Snap to land boundaries (1) or not (0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">orthogonalizationParameters</td><td>The orthogonalization parameters </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/runner/work/MeshKernel/MeshKernel/include/MeshKernel/<a class="el" href="_orthogonalization_and_smoothing_8hpp_source.html">OrthogonalizationAndSmoothing.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
